// {ΑG废醪嗓l
// dㄒ郎GFireRock.java

import java.applet.*;
import java.awt.*;
import java.awt.event.*;

public class FireRock extends Applet implements Runnable
{
   final int Max = 200;
   fparticle p[]; // 废醪嗓l
   int AppletWidth,AppletHeight,XCenter,YCenter;
   Image        OffScreen;
   Graphics     drawOffScreen;
   Thread pThread;

   public void init()
   {
      setBackground(Color.black); // ]wI春岸娄

      p = new fparticle[Max]; // 廿卟嗓l

      // o陪钩跋办
      AppletWidth = getSize().width;
      AppletHeight = getSize().height;

      // 废酹飑l旄m
      XCenter = (int) (Math.random()*AppletWidth);
      YCenter = (int) (Math.random()*AppletHeight);

      // 玻ネ锚飑lて采l
      for(int i=0; i<Max; i++)
          p[i] = new fparticle(XCenter,YCenter);

      // 廿擀傅e
      OffScreen     = createImage(AppletWidth,AppletHeight);
      drawOffScreen = OffScreen.getGraphics();
   }

   public void start()
   {
      pThread = new Thread(this);
      pThread.start();
   }

   public void stop()
   {
      pThread = null;
   }
 
   public void update(Graphics g)
   {
       paint(g);
   }

   public void paint(Graphics g)
   {
      g.drawImage(OffScreen,0,0,this);
   }

   public void run()
   {
      boolean reset = false;
      int i, t =0;
      while(true)
      {
         // Me
         drawOffScreen.clearRect(0,0,AppletWidth,AppletHeight);
  
         for(i=0; i<Max; i++)
         {
            // pGWX陪钩跋办A采l氦`
            if(p[i].X > AppletWidth || p[i].X < 0 || 
               p[i].Y > AppletHeight)
            {
               p[i].state = false;  
            }

            // pG采ls　Ah酶s采l
            if(p[i].state)
            {
               drawOffScreen.setColor(p[i].color);
               drawOffScreen.fillOval(p[i].X,p[i].Y,3,3);
               // 采l籁簿笆
   	       p[i].X += p[i].Vx;
               // 采lOvT
	       p[i].Y += p[i].Vy;
               // 采l匠t专OvT
	       p[i].Vy += 9*t;
            }                        
         }

         t++;  // 啥〖W[

         reset = true;  // 安]ゲ斗m采lA

         for(i=0; i<Max; i++)
         {
            if(p[i].state)  // pGΤ采ls
            {
               reset = false; // L惠m
               break;
            }
         }

         if(reset)  // pGゲ斗m采lA
         {
            // Mw采lいみ
            XCenter = (int) (Math.random()*AppletWidth);
            YCenter = (int) (Math.random()*AppletHeight);
            t = 0; // I癞啥÷ks
            // m┮Τ翰嗓lA
            for(i=0; i<Max; i++)
               p[i].reset(XCenter,YCenter);
         }
      
         // 酶e
         repaint();
 
         // 既氨磅婧 200 @
         try {
             Thread.sleep(200);
         }
         catch (InterruptedException e) { }
      }
   }
}

// 废醪嗓l摸O
class fparticle
{
   boolean state;  // ヘes―A
   int X,Y;      // 采l害旄m
   int Vx,Vy;    // 采l籁P匠t
   Color color;  // 采lC

   // 睾clA飑l采l
   public fparticle(int x,int y)
   {
      X = x;
      Y = y;
      reset(x,y);
   }

   // ]采lA
   public void reset(int x, int y)
   {
       state = true; 
       X = x;
       Y = y;
       // ㄏノ睹计Mw籁P匠t
       Vx = (int)(Math.random()*25 - Math.random()*25);
       Vy = (int)(Math.random()*25 - Math.random()*25);
       // ㄏノ睹计Mw采lC
       color = new Color((int)(Math.random()*255),
                         (int) (Math.random()*255),
                         (int) (Math.random()*255));
   }
}

